<!DOCTYPE html>
<html lang="en">
    
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title></title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
            integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
        .navbar-custom {
            background-color: #401a64 !important;
    
            .nav-link {
                color: white;
            }
        }
    
        main {
            h1 {
                width: 100%;
                margin: 0 20px;
            }
    
            h3 {
                width: 100%;
                margin: 20px;
            }
    
            #gestor {
                display: grid;
                grid-template-columns: 1fr 1fr;
                padding: 20px;
                place-content: center;
    
                #formularioProfesorsHandler,
                #formulariEstudiantesHandler {
                    margin-top: 20px;
                    display: grid;
                    grid-template-columns: 150px 300px;
                    place-content: center;
                    gap: 10px;
    
    
    
                    .table {
                        width: 85%;
                        max-width: 90%;
                        margin: 0 auto;
    
                    }
                }
    
                .btns-Profesor,
                .btns-Estudiante {
                    margin-top: 20px;
                    display: flex;
                    justify-content: center;
                    gap: 12px;
                }
    
    
            }
    
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg bg-body-tertiary navbar-custom">
        <div class="container-fluid">
            <div class="collapse navbar-collapse" id="navbarNavDropdown">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" aria-current="page" href="/">Home</a>
                    </li>
                    <li class="nav-item">
                        <a id="CursosVer" class="nav-link" href="#">Maestros</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Estudiantes</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Log out</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                            aria-expanded="false">
                            Otras Opciones
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#">Agregar Cursos</a></li>
                            <li><a class="dropdown-item" href="#">Agregar actividad</a></li>
                            <li><a class="dropdown-item" href="#">logout</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <main>
        <div id="bienvenida">
            <h1>bienvenido director: </h1>
        </div>

        <div id="gestor">
            <div class="agregarProfesorForm">
                <h1 class="text-center">Gestion de Profesor</h1>
                <form id="formularioProfesorsHandler" class="row">
                    <label for="codigoProfesor">Codigo :</label>
                    <input type="text" id="codigoProfesor" disabled>
                    <label for="correoProfesor">Correo :</label>
                    <input type="text" id="correoProfesor" value="maestro3@es.com">
                    <label for="NombresProfesor">nombres profesor:</label>
                    <input type="text" id="NombresProfesor" value="juan manuel">
                    <label for="apellidosProfesor">apellidos profesor:</label>
                    <input type="text" id="apellidosProfesor" value="lemus reyes">
                    <label for="contrasenaProfesor">contrasena:</label>
                    <input type="password" id="contrasenaProfesor" disabled>

                    <label for="cantidadAlumno">cursos totales:</label>
                    <input type="text" id="cantidadAlumno" disabled>

                    <label for="ComboxCursos">Tus Actividades:</label>
                    <select class="form-control" id="ComboxCursos">
                        <option value="">Selecciona una opción</option>
                    </select>
                </form>
            </div>
            <div class="agregarAlumnoForm">
                <h1 class="text-center">Gestion de Alumnos</h1>
                <form id="formulariEstudiantesHandler" class="row">
                    <label for="codigoAlumno">Codigo :</label>
                    <input type="text" id="codigoAlumno" disabled>
                    <label for="correoAlumno">Correo :</label>
                    <input type="text" id="correoAlumno" value="estudiante@es.com">
                    <label for="nombresAlumno">Alumno nombres:</label>
                    <input type="text" id="nombresAlumno" value="luis fernando">
                    <label for="apellidosAlumno">Alumno apellidos:</label>
                    <input type="text" id="apellidosAlumno" value="gonzales giron">
                    <label for="contrasenaAlumno">Alumno contraseña:</label>
                    <input type="text" id="contrasenaAlumno" disabled>
                    <label for="cantidadCursos">cursos inscritos:</label>
                    <input type="text" id="cantidadCursos" disabled>
                    <label for="ComboxCursos">Tus Actividades:</label>
                    <select class="form-control" id="ComboxCursos">
                        <option value="">Selecciona una opción</option>
                    </select>
                </form>
            </div>
            <div class="btns-Profesor">
                <button type="button" id="btnAgregarpROFESOR" class="btn btn-secondary btn-limited btn-custom">CREAR
                    PROFESOR</button>
                <button type="button" id="btnBuscarProfesor"
                    class="btn btn-secondary btn-limited btn-custom">BUSCAR</button>
                <button type="button" id="btnMatricularProfesor"
                    class="btn btn-secondary btn-limited btn-custom">CONTRATAR</button>
                <button type="button" id="btnEliminarProfesor"
                    class="btn btn-secondary btn-limited btn-custom">ELIMINAR</button>
                <button type="button" id="btnLimpiarProfesor"
                    class="btn btn-secondary btn-limited btn-custom">LIMPIAR</button>
            </div>
            <div class="btns-Estudiante">
                <button type="button" id="btnAgregarEstudiante" class="btn btn-secondary btn-limited btn-custom">CREAR
                    ESTUDIANTE </button>
                <button type="button" id="btnBuscarEstudiante"
                    class="btn btn-secondary btn-limited btn-custom">BUSCAR</button>
                <button type="button" id="btnEliminaEstudiante"
                    class="btn btn-secondary btn-limited btn-custom">ELIMINAR</button>
                <button type="button" id="btnModificarEstudiante"
                    class="btn btn-secondary btn-limited btn-custom">MODIFICAR</button>
                <button type="button" id="btnLimpiarCurso"
                    class="btn btn-secondary btn-limited btn-custom">LIMPIAR</button>
            </div>
    </main>

    <script>
        //componente director
        const bienvenida = document.getElementById('bienvenida')
        //diretor 
        let idDirector;
        let nombreDirector;
        const accessToken = localStorage.getItem("accessToken");
        const refreshToken = localStorage.getItem("refreshToken");

        //    // Componentes del formulario de Profesor
        const codigoProfesorInput = document.getElementById('codigoProfesor');
        const correoProfesorInput = document.getElementById('correoProfesor');
        const nombresProfesorInput = document.getElementById('NombresProfesor');
        const apellidosProfesor = document.getElementById('apellidosProfesor');
        const contrasenaProfesor = document.getElementById('contrasenaProfesor');
        const cantidadAlumnoInput = document.getElementById('cantidadAlumno');
        const comboxCursosProfesor = document.getElementById('ComboxCursos');

        // Componentes del formulario de Estudiante
        const codigoAlumnoInput = document.getElementById('codigoAlumno');
        const correoAlumnoInput = document.getElementById('correoAlumno');
        const nombresAlumnoInput = document.getElementById('nombresAlumno');
        const apellidosAlumnoInput = document.getElementById('apellidosAlumno');
        const contrasenaAlumnoInput = document.getElementById('contrasenaAlumno');
        const cantidadCursosInput = document.getElementById('cantidadCursos');
        const comboxCursosAlumno = document.getElementById('ComboxCursos'); // Select del Estudiante

        // Botones de Profesor
        const btnCrearProfesor = document.getElementById('btnAgregarpROFESOR');
        const btnBuscarProfesor = document.getElementById('btnBuscarProfesor');
        const btnMatricularProfesor = document.getElementById('btnMatricularProfesor');
        const btnEliminarProfesor = document.getElementById('btnEliminarProfesor');
        const btnLimpiarProfesor = document.getElementById('btnLimpiarProfesor');

        // Botones de Estudiante
        const btnCrearEstudiante = document.getElementById('btnAgregarEstudiante');
        const btnBuscarEstudiante = document.getElementById('btnBuscarEstudiante');
        const btnEliminarEstudiante = document.getElementById('btnEliminaEstudiante');
        const btnModificarEstudiante = document.getElementById('btnModificarEstudiante');
        const btnLimpiarEstudiante = document.getElementById('btnLimpiarCurso');


        document.addEventListener('DOMContentLoaded', async (e) => {
            await buscarInfoDirector();
        });

        const buscarInfoDirector = async () => {
            try {
                const response = await fetch(`http://localhost:3000/api/public/usuariobyToken`, {
                    method: "GET",
                    headers: {
                        'Content-Type': 'application/json',
                        'AccessToken': accessToken,
                        'RefreshToken': refreshToken
                    }
                });

                if (response.ok) {
                    const director = await response.json();
                    if (director) {
                        idDirector = director._id;
                        nombreDirector = `${director.nombres} ${director.apellidos}`;
                        bienvenida.innerHTML = `
                            <h3>Bienvenido director: ${nombreDirector}</h3>
                        `;
                    }
                } else {
                    alert("No se encontró al director");
                }
            } catch (error) {
                console.log(error);
            }
        };

        btnCrearProfesor.addEventListener('click', async () => {
            const nombres = nombresProfesorInput.value
            const apellidos = apellidosProfesor.value
            const correo = correoProfesorInput.value
            const contrasena ="12345"
            try {
                const response = await fetch(`http://localhost:3000/api/public/registro`, {
                    method: "POST",
                    headers: {
                        'Content-Type': 'application/json',
                        'AccessToken': accessToken,
                        'RefreshToken': refreshToken
                    },
                    body: JSON.stringify({
                        "nombres": nombres,
                        "apellidos": apellidos,
                        "correo": correo,
                        "contrasena": contrasena,
                        "role": "maestro"
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    alert("profesor creado exitosamente")
                   console.log(data);
                } else {
                    alert("No se pudo crear al profesor");
                }
            } catch (error) {
                console.log(error);
            }
        })
        btnCrearEstudiante.addEventListener('click', async () => {
            const nombres = nombresAlumnoInput.value
            const apellidos = apellidosAlumnoInput.value
            const correo = correoAlumnoInput.value
            const contrasena =contrasenaAlumnoInput.value
            try {
                const response = await fetch(`http://localhost:3000/api/public/registro`, {
                    method: "POST",
                    headers: {
                        'Content-Type': 'application/json',
                        'AccessToken': accessToken,
                        'RefreshToken': refreshToken
                    },
                    body: JSON.stringify({
                        "nombres": nombres,
                        "apellidos": apellidos,
                        "correo": correo,
                        "contrasena": "12345",
                        "role": "estudiante"
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    alert("estudiante creado exitosamente")
                   console.log(data);
                } else {
                    alert("No se pudo crear al estudiante");
                }
            } catch (error) {
                console.log(error);
            }
        })

    </script>
</body>

</html>